let library = [
    {   artist: "Senses Fail",
        artistThumb: "/resources/artistthumb/sensesfail.jpeg",
        genre: "Rock",
        albums:[{   title: "Let It Enfold You",
                    tracks:[
                            {   tracktitle: "Lady In A Blue Dress",
                                lyrics: [
                                        `Just like the lady in the blue dress<br/>
                                        you've got cigarettes on your breath<br/>
                                        Hairspray and some cheap perfume`,
                                        `You said, said you want respect<br/>
                                        Well then you better get some for yourself<br/>
                                        'Cause all that I see right now<br/>
                                        Is someone whose lost and insecure`, 
                                        `Don't try to be cute with me<br/>
                                        'Cause I know you hate yourself<br/>
                                        And you'd end your stupid lies now<br/>
                                        But you're too spineless`
                                    ],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "You're Cute When Your Scream",
                                lyrics: [
                                    `You know that you are worthless<br/>
                                    And I am better than<br/>
                                    The games that you play princess<br/>
                                    I've played and always win`,
                                    `I'll take you to the top<br/>
                                    Of this building and just push you off<br/>
                                    Run down the stairs so I can see<br/>
                                    Your face as you hit the street`,
                                    `I'll take my time<br/>
                                    To slowly plot your end<br/>
                                    But now I will<br/>
                                    Spit bullets with my pen`
                                ],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Bite To Break Skin",
                                lyrics: [
                                    `So let me take this medicine<br/>
                                    To quench my love for violent things
                                    My swan song will
                                    Be like a bullet laced in anger
                                    As the razor cuts the soft spot on your heel`,
                                    `So, follow me into the sun
                                    And I will bleed the poision dry`,
                                    `Don't give the secret
                                    My stoic face
                                    Bleeding with passion
                                    The Phoenix will die
                                    Inside the firestorm
                                    I am the son
                                    Follow my footsteps.`
                                ],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "Still Searching",
                    tracks:[
                            {   tracktitle: "Bonecrusher",
                                lyrics: [
`I feel the city breathe at night
Beneath the stars and meteor lights
And I've got nothing to lose`,
`Drink up, drink up
Drink up the loneliness
Drink up, drink up
Drink up the loneliness`,
`And I got romantic ideas
But they're not meant for you
And my bed's filled with black roses
To show that our love is through`],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Can't Be Saved",
                                lyrics: [
`Follow your bliss
If it's on my chest
I know I got it tattooed for a reason
Why can't I just hold it true`,
`I'm stuck in a coma
Stuck in a never ending sleep
Someday I will wake up
And realize I made up everything`,
`We can all hang ourselves
From gold chandeliers
And drink it back to all,
All the pain it feels
Loose lips and sunken ship
To a shallow grave
Washed up upon the rocks`],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Calling All Cars",
                                lyrics: [
`I'm sorry, but I think I failed to mention
That I lied at my very first confession
What did you expect from me?
What did you expect from me?`,
`So will you scatter my ashes where they won't be found?
I kept my word when I swore that I would let you down
And now that I'm gone
Try to forget me, and just move on`,
`I don't have love left, inside, inside
And I don't have love left, inside, inside
Are you desperate for an answer? I don't have an ounce of good
Left in me now, that's why I walked out`],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    },
    {   artist: "Funeral For A Friend",
        genre: "Rock",
        artistThumb: "/resources/artistthumb/ffaf.jpeg",
        albums:[{   title: "Casually Dressed And Deep In Conversation",
                    tracks:[
                            {   tracktitle: "Rookie Of The Year",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Juneau",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Bend Your Arms To Look Like Wings",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "Hours",
                    tracks:[
                            {   tracktitle: "All The Rage",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Streetcar",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Roses For The Dead",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    },
    {   artist: "Taylor Swift",
        genre: "Pop",
        artistThumb: "/resources/artistthumb/ts.jpeg",
        albums:[{   title: "Fearless",
                    tracks:[
                            {   tracktitle: "Love Story",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "You Belong With Me",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Tell Me Why",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "Speak Now",
                    tracks:[
                            {   tracktitle: "Mine",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Sparks Fly",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Back To December",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    },
    {   artist: "Westlife",
        genre: "Pop",
        artistThumb: "/resources/artistthumb/westlife.jpeg",
        albums:[{   title: "Westlife",
                    tracks:[
                            {   tracktitle: "Fool Again",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Flying Without Wings",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "More Than Words",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "Coast To Coast",
                    tracks:[
                            {   tracktitle: "My Love",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "What Makes A Man",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "I Lay My Love On You",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    },
    {   artist: "Avenged Sevenfold",
        genre: "Metal",
        artistThumb: "/resources/artistthumb/a7x.jpeg",
        albums:[{   title: "Waking The Fallen",
                    tracks:[
                            {   tracktitle: "Unholy Confessions",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Chapter Four",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Eternal Rest",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "City Of Evil",
                    tracks:[
                            {   tracktitle: "Beast And The Harlot",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Bat Country",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Seize The Day",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    },
    {   artist: "blessthefall",
        genre: "Metal",
        artistThumb: "/resources/artistthumb/btf.jpeg",
        albums:[{   title: "His Last Walk",
                    tracks:[
                            {   tracktitle: "Guys Like You Make Us Look Bad",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Higinia",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "Rise Up",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                },
                {   title: "Witness",
                    tracks:[
                            {   tracktitle: "What's Left Of Me",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "To Hell & Back",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                            {   tracktitle: "God Wears Gucci",
                                lyrics: ["excerpt 1", "excerpt 1", "excerpt 1"],
                                clip: ["clip 1", "clip 2", "clip 3"]
                            },
                        ]
                }
        ]
    }
];
let mode = "";
let diff = "";
let genre = "";
let artistIndex = "";

// get artists/genres from library and populate the choice menu
function fillArtist(){
    let cArtist = $("#artist-select");

    library.forEach ((x, index) =>{
        let thumbPath = x.artistThumb;
        let image = document.createElement("img");
        image.setAttribute("src", thumbPath);
        image.setAttribute("data-id", index);
        image.setAttribute("class", "artist");
        cArtist.append(image);
    });
};
fillArtist();

function fillGenre(){
    let cGenre = $("#genre-select");

    library.forEach (x =>{
        let curr = x.genre
        let chk = document.getElementsByClassName("genre-option");
        let exists = false;

        for (let y of chk){
            if (y.getAttribute("data-id") == curr){
                exists = true;
            }
        }
        
        if (!exists){
            let genre = document.createElement("div");
            genre.setAttribute("class", "genre-option");
            genre.setAttribute("data-id", curr);
            genre.innerText = curr;
            cGenre.append(genre);
        }
    });
};
fillGenre();

// selecting options
$(".mode-option").click(function(){
    let box = $(this).parent().parent().parent().attr("id");
    let curr = $(this).attr("data-id");
    let mo = document.getElementById(box).getElementsByClassName("mode-option");
    let downed;
    let button;

    // check if any button is clicked
    function notOnlyOne (){
        let test = 0;
        for (let x of mo){
            if (x.classList.contains("clicked")){
                test++;
                downed = x.attributes["data-id"].nodeValue;
                button = x;
            }
        }
        return test;
    }

    // store game settings
    function setSetting (){
        if (box == "mode") {
            mode = curr;
        }else{
            diff = curr;
        }
    }

    // to depress button or to switch button
    if (notOnlyOne()){
        if (downed != curr){
            button.classList.remove("clicked")
            $(this).addClass("clicked");
            setSetting();
        }
    }else{
        $(this).addClass("clicked");
        setSetting();
    }
});

// clicking start
$("#start").click(function(){
    // check if options are valid
    let str = "";
    if (mode == "" || diff == ""){
        if (mode == "" && diff == ""){
            str = "game mode and difficulty";
        }else if (mode == ""){
            str = "game mode";
        }else{
            str = "difficulty";
        }

        swal({
            title: "Please select your options",
            text: "You didn't select the " + str, 
            icon: "error",
          });
    }else {
        let rules = $("#rules");
        let options = $("#options");
        let cArtist = $("#choose-artist");
        let cGenre = $("#choose-genre");
        
        // hide current windows and show 2nd option window
        options.hide();
        rules.hide();

        setTimeout(function () {
            if (mode == "artist"){
                cArtist.show();
            }else if (mode == "genre"){
                cGenre.show();
            }else {
                cArtist.show();
                cGenre.show();
            }
        }, 500);
    }
});

// Back to menu button
$(".back").click(function(){
    let box = $(this).parent().parent().parent();
    
        box.hide();

        setTimeout( function() {
            $("#rules").show();
            $("#options").show();          
        }, 500);
});

$(".artist").click(function(){
    artistIndex = $(this).attr("data-id");
    let insert = $(".logo");

    let thumbPath = library[artistIndex].artistThumb;
    let image = document.createElement("img");
    image.setAttribute("src", thumbPath);
    insert.append(image);

    $("#landing").hide();
    $("#game").show();
    $("#lyric-box").show();

    playLyric(artistIndex);
});

function playLyric(artist) {
    let score = 0;
    let questions = [];
    let clueBox = $("#lyric");
    let guessBox = $(".guess");
    let curr = {title: "", lyric: ""};
    let wrong = [];
    let done = [];
    let chosenArtist = library[artist];
    let noOfAlbums = chosenArtist.albums.length;

    function getRandomSong() {
        let albumRand = generateRandom(noOfAlbums);
        let pointedAlbum = chosenArtist.albums[albumRand];
        let numOfSongs = pointedAlbum.tracks.length;
        let songRand = generateRandom(numOfSongs);
        let pointedSong = pointedAlbum.tracks[songRand];
        let randLyr = generateRandom(pointedSong.lyrics.length);
        
        let final = {title: pointedSong.tracktitle, lyric: pointedSong.lyrics[randLyr]};
        
        return final;
    }

    for (let i = 0; i < 5; i++){
        let x = getRandomSong();
        let repeat = false;

        do{
            for (let y of questions){
            
            }
        }while (!repeat);
        
        questions.push(getRandomSong());
    }
    console.log(questions);
}

function generateRandom(x) {
    return Math.floor(Math.random()*x);
}

//console.log(library[0].albums[0].tracks[0].lyrics[1]);

/* /* function tranIn(x) {
    x.show();
    x.addClass("animate__animated animate__backInUp animate__slow");
    x.on('animationend', () => {
        x.removeClass("animate__animated animate__backInUp animate__slow");
    });
}

function tranOut(x) {
    x.on('animationend', () => {
        x.hide();
        x.removeClass("animate__animated animate__backOutDown animate__slow");
    });
    x.addClass("animate__animated animate__backOutDown animate__slow");
} */

// set options as buttons, put data-id of the artist/genre in the respective boxes




// the old recursive method
/* let count = 5;
    let clueBox = $("#lyric");
    let guessBox = $(".guess");
    let curr = {title: "", lyric: ""};
    let wrong = [];
    let albumRand = 0;
    let songRand = 0;
    let lyricsRand = 0;
    let done = [];
    let chosenArtist = library[artist];
    let noOfAlbums = chosenArtist.albums.length;
    let pointedAlbum;
    let numOfSongs;
    let pointedSong;
    let score = 0;

    function getRandomSong() {
        albumRand = generateRandom(noOfAlbums);
        pointedAlbum = chosenArtist.albums[albumRand];
        numOfSongs = pointedAlbum.tracks.length;
        songRand = generateRandom(numOfSongs);
        pointedSong = pointedAlbum.tracks[songRand];
        return;
    }

    function correctAnswer() {
        getRandomSong();

        if (!done.includes(pointedSong.tracktitle)){
            lyricsRand = generateRandom(pointedSong.lyrics.length);
        
            curr.title = pointedSong.tracktitle;
            curr.lyric = pointedSong.lyrics[lyricsRand];
            done.push(curr.title);
        }else{
            correctAnswer();
        }
        return;
    }

    function getOtherAnswers() {
            getRandomSong();
            if(pointedSong.tracktitle != curr.title){
                wrong.push(pointedSong.tracktitle);
            }else{
                getOtherAnswers();
            }
        return;
    }

    function getNonArtist (){
        while (wrong.length < 2){
            let randomArtist = library[generateRandom(library.length)];
            while (randomArtist.artist == chosenArtist.artist){
                randomArtist = library[generateRandom(library.length)];
            }
            
            let rAAlbum = randomArtist.albums[generateRandom(randomArtist.albums.length)];
            let rASong = rAAlbum.tracks[generateRandom(rAAlbum.tracks.length)];

            if(!wrong.includes(rASong.tracktitle)){
                wrong.push(rASong.tracktitle);
            }
            else{
                getNonArtist();
            }
        }
        return;
    }

    function generateQuestion (){
        correctAnswer();
        getNonArtist();
        getOtherAnswers();
        
        wrong.push(curr.title);
        clueBox.text(curr.lyric);
        
        console.log (count + " more questions left");
        console.log ("score" + score);
        
        for (let i = 0; i< guessBox.length; i++){
            let now = generateRandom(wrong.length);
            guessBox[i].innerText = wrong[now];
            if (wrong.length!=1){
                wrong.splice(now, 1);
            }
        };

        guessBox.click(function (){
            let guess = $(this).text();
            if (guess == curr.title){
                swal({
                    title: "you chose CORRECTLY",
                    text: guess,
                  });
                  score++;
                  count--;
                  setTimeout(generateQuestion, 2000);
            }else{
                swal({
                    title: "you chose WONRGLY",
                    text: guess,
                  });
            }
        });
        return;
    }
    generateQuestion (); */